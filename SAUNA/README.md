# SAUNA Peak Caller

The SAUNA peak caller is designed to simulate nucleosome positions on fragment center data. It takes input files containing peak positions and nucleosome center data, applies parameters defined in a configuration file, and generates an output file with the simulated nucleosome positions. 

The project contains code adapted from the NucPosSimulator project by Schöpflin et al. 2013, licensed under GLP-3.0 . For the paper of the NucPosSimulator project see: Robert Schöpflin, Vladimir B. Teif, Oliver Müller, Christin Weinberg, Karsten Rippe, Gero Wedemann, Modeling nucleosome position distributions from experimental nucleosome positioning maps, Bioinformatics, Volume 29, Issue 19, October 2013, Pages 2380–2386, https://doi.org/10.1093/bioinformatics/btt404
The code was re-written in python and refactored 
- to optimize memory usage and speed: 
  1. initialization, 
  2. use of memory mapping, 
  3. vectorized operations instead of for loops
  
  These changes enable the analysis of whole genomes, giving utility in whole-genome cfDNA-sequencing
- to change certain parameters to accomodate the optimization steps
- to fit python logic (instead of C++)
- for legibility
- new functions were added to extend the tool's utility

## Usage

To run the SAUNA peak caller, use the following command:
```shell
python SAUNA.py <peak_output.tsv> <nucleosome_center_data.tsv.gz> <params.txt> [output-path]
```

### Inputs:

- `<peak_output.tsv>`: 
  - A TSV input file containing peaks generated by another peak caller.
  - This file should have two columns: 
    - Column 1: Chromosome name 
    - Column 2: Peak positions.

- `<nucleosome_center_data.tsv.gz>`: 
  - A compressed TSV input file containing nucleosome center data.
  - This file should have four columns:
    - Column 1: Chromosome name
    - Column 2: Genomic positions
    - Column 3: Raw fragment center data. This data is not used in the simulation. Thus, the column can be left empty.
    - Column 4: Smoothed fragment center data.
  - All data in this file should correspond to the same chromosome.

- `<params.txt>`: 
  - A parameter file that specifies various options for the simulation.

- `[output-path]`: 
  - An optional path to an alternative output directory for saving the results.

## Output

The output of the SAUNA peak caller is a BED file with three columns:
- Column 1: Chromosome name
- Column 2: Start position of the nucleosome
- Column 3: End position of the nucleosome

The BED file will be generated based on the specified parameters and saved in the designated output directory (or the default output location if none is specified).
